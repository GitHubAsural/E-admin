{"version":3,"sources":["webpack:///./src/components/EadminAmap.vue","webpack:///./src/components/EadminAmap.vue?d54a","webpack:///./src/components/EadminAmap.vue?4611"],"names":["ref","style","class","mapAddress","append","icon","drawer","custom-class","append-to-body","direction","size","destroy-on-close","with-header","init","body-style","id","searchText","placeholder","prefix-icon","name","props","modelValue","String","lat","Number","lng","apiKey","type","default","emits","setup","ctx","container","loadScript","url","jsapi","document","createElement","charset","src","head","appendChild","getElementById","val","emit","map","geolocation","placeSearch","marker","geocoder","mapLng","mapLat","onComplete","data","position","formattedAddress","setCenter","AMap","Marker","info","push","infoWindow","InfoWindow","content","join","offset","Pixel","open","setFitView","clickMap","e","getAddress","lnglat","status","result","regeocode","updateEmit","remove","Geocoder","extensions","Map","value","resizeEnable","plugin","Geolocation","enableHighAccuracy","timeout","buttonOffset","zoomToAccuracy","buttonPosition","getCurrentPosition","event","addListener","on","auto","Autocomplete","input","PlaceSearch","addControl","ToolBar","location","href","indexOf","setStatus","scrollWheel","select","address","poi","setCity","adcode","search","district","render"],"mappings":"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","file":"static/js/chunk-834404aa.f2c2147b.js","sourcesContent":["<template>\r\n  <div>\r\n    <el-input v-model=\"mapAddress\">\r\n      <template #append><el-button icon=\"el-icon-map-location\" @click=\"drawer = true\">地图</el-button></template>\r\n    </el-input>\r\n    <el-drawer\r\n      custom-class=\"el-drawers\"\r\n      :append-to-body=\"true\"\r\n      v-model=\"drawer\"\r\n      direction=\"ttb\"\r\n      size=\"50%\"\r\n      :destroy-on-close=\"true\"\r\n      :with-header=\"false\"\r\n      @opened=\"init\"\r\n    >\r\n      <div ref=\"container\" style=\"width: 100%;height: 100%\" />\r\n      <div style=\"position: absolute;left: 80px;top: 10px\">\r\n        <el-card :body-style=\"{ padding: '10px'}\">\r\n          <el-input id=\"tipinput\" v-model=\"searchText\" placeholder=\"请输入关键字\" size=\"mini\" prefix-icon=\"el-icon-search\" />\r\n        </el-card>\r\n      </div>\r\n      <div style=\"position: absolute;right: 10px;bottom: 10px\">\r\n        <el-card :body-style=\"{ padding: '10px',}\">\r\n          <div class=\"info\"><b>当前选择地址: </b>{{ mapAddress }}</div>\r\n        </el-card>\r\n      </div>\r\n    </el-drawer>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {defineComponent, ref,watch,onMounted} from \"vue\";\r\nexport default defineComponent({\r\n  name: 'EadminAmap',\r\n  props: {\r\n    modelValue: String,\r\n    lat: [Number, String],\r\n    lng: [Number, String],\r\n    apiKey: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  emits:['update:modelValue','update:lat','update:lng'],\r\n  setup(props,ctx){\r\n    const container = ref('')\r\n    const searchText = ref('')\r\n    const drawer = ref(false)\r\n    const mapAddress = ref(props.modelValue)\r\n\r\n    function loadScript(url, id) {\r\n      const jsapi = document.createElement('script')\r\n      jsapi.charset = 'utf-8'\r\n      jsapi.id = id\r\n      jsapi.src = url\r\n      document.head.appendChild(jsapi)\r\n    }\r\n    onMounted(()=>{\r\n      if (document.getElementById('amapscript') == null) {\r\n        const url = 'https://webapi.amap.com/maps?v=1.4.15&key=' + props.apiKey + '&plugin=AMap.Autocomplete,AMap.PlaceSearch,AMap.Geocoder,AMap.Geolocation'\r\n        loadScript(url, 'amapscript')\r\n      }\r\n    })\r\n    watch(mapAddress,(val)=>{\r\n      ctx.emit('update:modelValue',val)\r\n    })\r\n\r\n    let map = null\r\n    let geolocation = null\r\n    let placeSearch = null\r\n    let marker = null\r\n    let geocoder = null\r\n\r\n    let mapLng = props.lng\r\n    let mapLat = props.lat\r\n    function onComplete(data) {\r\n      // data是具体的定位信息\r\n      mapLat = data.position.lat\r\n      mapLng = data.position.lng\r\n      ctx.emit('update:modelValue',data.formattedAddress)\r\n      ctx.emit('update:lat',mapLat)\r\n      ctx.emit('update:lng',mapLng)\r\n      position()\r\n    }\r\n    function position() {\r\n      map.setCenter([mapLng, mapLat])\r\n      marker = new AMap.Marker({\r\n        position: [mapLng, mapLat],\r\n        map: map\r\n      })\r\n      const info = []\r\n      info.push(\"<div class='input-card content-window-card'> \")\r\n      info.push(\"<p class='input-item'>\" + props.modelValue + '</p></div></div>')\r\n      const infoWindow = new AMap.InfoWindow({\r\n        content: info.join(''),\r\n        offset: new AMap.Pixel(0, -35)\r\n      })\r\n      infoWindow.open(map, [mapLng, mapLat])\r\n      map.setFitView([marker])\r\n    }\r\n    function clickMap(e) {\r\n      geocoder.getAddress(e.lnglat, (status, result) => {\r\n        if (status === 'complete' && result.regeocode) {\r\n          updateEmit(result.regeocode.formattedAddress,e.lnglat.lat,e.lnglat.lng)\r\n          if (marker) {\r\n            map.remove(marker)\r\n          }\r\n          position()\r\n        }\r\n      })\r\n    }\r\n    function init() {\r\n      geocoder = new AMap.Geocoder({\r\n        extensions: 'all'\r\n      })\r\n\r\n      map = new AMap.Map(container.value, {\r\n        resizeEnable: true\r\n      })\r\n\r\n      if (props.modelValue) {\r\n        position()\r\n      } else {\r\n        AMap.plugin('AMap.Geolocation', () => {\r\n          geolocation = new AMap.Geolocation({\r\n            // 是否使用高精度定位，默认：true\r\n            enableHighAccuracy: true,\r\n            // 设置定位超时时间，默认：无穷大\r\n            timeout: 10000,\r\n            // 定位按钮的停靠位置的偏移量，默认：Pixel(10, 20)\r\n            buttonOffset: new AMap.Pixel(10, 20),\r\n            //  定位成功后调整地图视野范围使定位位置及精度范围视野内可见，默认：false\r\n            zoomToAccuracy: true,\r\n            //  定位按钮的排放位置,  RB表示右下\r\n            buttonPosition: 'RB'\r\n          })\r\n        })\r\n        geolocation.getCurrentPosition()\r\n        AMap.event.addListener(geolocation, 'complete', onComplete)\r\n      }\r\n      map.on('click', clickMap)\r\n      // 输入提示\r\n      const auto = new AMap.Autocomplete({\r\n        input: 'tipinput'\r\n      })\r\n      placeSearch = new AMap.PlaceSearch({\r\n        map: map\r\n      })\r\n      map.plugin(['AMap.ToolBar'], () => {\r\n        map.addControl(new AMap.ToolBar())\r\n      })\r\n      if (location.href.indexOf('&guide=1') !== -1) {\r\n        map.setStatus({ scrollWheel: false })\r\n      }\r\n      AMap.event.addListener(auto, 'select', select)// 注册监听，当选中某条记录时会触发\r\n      AMap.event.addListener(placeSearch, 'markerClick', e => {\r\n        updateEmit(e.data.address,e.data.location.lat,e.data.location.lng)\r\n      })\r\n    }\r\n    function updateEmit(address,lat,lng) {\r\n      mapLat = lat\r\n      mapLng = lng\r\n      mapAddress.value = address\r\n      ctx.emit('update:modelValue',address)\r\n      ctx.emit('update:lat',lat)\r\n      ctx.emit('update:lng',lng)\r\n    }\r\n    function select(e) {\r\n      const poi = e.poi\r\n      placeSearch.setCity(poi.adcode)\r\n      placeSearch.search(poi.name) // 关键字查询查询\r\n      updateEmit(poi.district + poi.address,poi.location.lat,poi.location.lng)\r\n    }\r\n    return {\r\n      init,\r\n      searchText,\r\n      drawer,\r\n      mapAddress,\r\n      container\r\n    }\r\n  },\r\n})\r\n</script>\r\n<style >\r\n  .amap-sug-result {\r\n    z-index: 10000 !important;\r\n  }\r\n  .amap-sug-result .auto-item {\r\n    font-size: 14px;\r\n    padding: 5px 0px;\r\n    text-indent: 10px;\r\n  }\r\n</style>\r\n","import { render } from \"./EadminAmap.vue?vue&type=template&id=dda2647e\"\nimport script from \"./EadminAmap.vue?vue&type=script&lang=js\"\nexport * from \"./EadminAmap.vue?vue&type=script&lang=js\"\n\nimport \"./EadminAmap.vue?vue&type=style&index=0&id=dda2647e&lang=css\"\nscript.render = render\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EadminAmap.vue?vue&type=style&index=0&id=dda2647e&lang=css\""],"sourceRoot":""}